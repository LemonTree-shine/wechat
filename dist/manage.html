<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>菜单配置</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>
<body>
    <textarea name="menu" id="" cols="150" rows="30"></textarea>
    <div>
        <button>配置微信菜单</button>
        <div>群发消息</div>
    </div>
</body>
<script>
    var url = "//localhost";
    if(/www\.xiaogangji\.com/.test(window.location.origin)){
        url = '//www.xiaogangji.com'
    }
    
    document.querySelector("button").addEventListener("click",()=>{
        $.ajax({
            url:url+"/setMenu",
            type:"post",
            data:{menu:document.querySelector("textarea").value},
            success:function(result){
                var data = JSON.parse(result);
                alert(data.errmsg);
                // console.log(typeof data)
            }
        });
    })
    $.ajax({
        url:url+"/getMenu",
        type:"get",
        success:function(result){
            // var data = JSON.parse(result);
            // alert(data.errmsg);
            console.log(result.menu)
            document.querySelector("textarea").value = result.menu;
        }
    });
    //群发消息
    document.querySelector("div").addEventListener("click",()=>{
        $.ajax({
            url:url+"/sendAll",
            type:"post",
            success:function(result){
                var data = JSON.parse(result);
                alert(data.errmsg);
                // console.log(typeof data)
            }
        });
    })
</script>
</html>